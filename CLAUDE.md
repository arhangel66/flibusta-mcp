# Flibusta MCP Server

MCP (Model Context Protocol) —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∫–Ω–∏–≥ —Å —Å–∞–π—Ç–∞ Flibusta.

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç MCP —Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å:
- –ü–æ–∏—Å–∫–∞ –∫–Ω–∏–≥ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/—Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é
- –ü–æ–∏—Å–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∫–Ω–∏–≥ –ø–æ –∞–≤—Ç–æ—Ä—É
- –ü–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–Ω–∏–≥–µ
- –°–∫–∞—á–∏–≤–∞–Ω–∏—è –∫–Ω–∏–≥ –≤ —Ñ–æ—Ä–º–∞—Ç–µ EPUB

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º OOP —Å dependency injection:

```
üìÅ mcp_books/
‚îú‚îÄ‚îÄ üêç flibusta_mcp.py      # –û—Å–Ω–æ–≤–Ω–æ–π MCP —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ üîß construct.py         # Dependency Injection
‚îú‚îÄ‚îÄ ‚öôÔ∏è  config.py           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ üìö models/              # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (Book, Author)
‚îú‚îÄ‚îÄ üõ†  services/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ client.py          # HTTP –∫–ª–∏–µ–Ω—Ç (aiohttp)
‚îÇ   ‚îú‚îÄ‚îÄ parser.py          # HTML –ø–∞—Ä—Å–µ—Ä (BeautifulSoup)
‚îÇ   ‚îî‚îÄ‚îÄ service.py         # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
‚îú‚îÄ‚îÄ üß™ tests/              # –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ üìÑ test_data/          # HTML –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤
```

## –§—É–Ω–∫—Ü–∏–∏ MCP

### 1. search_books(book_query: str) -> str
–ü–æ–∏—Å–∫ –∫–Ω–∏–≥ –ø–æ –∑–∞–ø—Ä–æ—Å—É.
```python
await search_books("–ö–æ–≤–∏")
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ –∫–Ω–∏–≥–∞–º–∏
```

### 2. search_authors(author_query: str) -> str  
–ü–æ–∏—Å–∫ –∞–≤—Ç–æ—Ä–æ–≤ –ø–æ –∑–∞–ø—Ä–æ—Å—É.
```python
await search_authors("–ö–æ–≤–∏")
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ –∞–≤—Ç–æ—Ä–∞–º–∏
```

### 3. search_books_by_author(author_id: str) -> str
–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–Ω–∏–≥ –∞–≤—Ç–æ—Ä–∞ –ø–æ –µ–≥–æ ID.
```python
await search_books_by_author("50647")
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å –∫–Ω–∏–≥–∞–º–∏ –°—Ç–∏–≤–µ–Ω–∞ –ö–æ–≤–∏
```

### 4. get_book_details(book_id: str) -> str
–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–Ω–∏–≥–µ.
```python
await get_book_details("417291")
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å –¥–µ—Ç–∞–ª—è–º–∏ –∫–Ω–∏–≥–∏
```

### 5. download_book(book_id: str) -> str
–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ EPUB.
```python
await download_book("417291")
# –°–∫–∞—á–∏–≤–∞–µ—Ç –∫–Ω–∏–≥—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `FLIBUSTA_DOWNLOAD_DIR` - –ø–∞–ø–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∫–Ω–∏–≥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `~/Documents/books/`)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MCP
–í `mcp_config.json` –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç–µ MCP:
```json
{
  "mcpServers": {
    "flibusta": {
      "command": "python",
      "args": ["/path/to/flibusta_mcp.py"]
    }
  }
}
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **FastMCP** - MCP —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **aiohttp** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç
- **BeautifulSoup4** - –ø–∞—Ä—Å–∏–Ω–≥ HTML
- **pytest** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **ruff** - –ª–∏–Ω—Ç–µ—Ä –∏ —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä
- **uv** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
uv add fastmcp aiohttp beautifulsoup4 lxml
```

2. –ó–∞–ø—É—Å–∫ MCP —Å–µ—Ä–≤–µ—Ä–∞:
```bash
python flibusta_mcp.py
```

3. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
pytest tests/
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–∏—Å–∫ –∫–Ω–∏–≥–∏ –°—Ç–∏–≤–µ–Ω–∞ –ö–æ–≤–∏
```python
# 1. –ü–æ–∏—Å–∫ –∞–≤—Ç–æ—Ä–∞
authors = await search_authors("–ö–æ–≤–∏")
stephen_covey_id = "50647"  # ID –°—Ç–∏–≤–µ–Ω–∞ –ö–æ–≤–∏

# 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–Ω–∏–≥ –∞–≤—Ç–æ—Ä–∞
books = await search_books_by_author(stephen_covey_id)

# 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –∫–Ω–∏–≥–∏
book_details = await get_book_details("417291")

# 4. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏
file_path = await download_book("417291")
```

### –ü–æ–∏—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–Ω–∏–≥–∏
```python
# –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
books = await search_books("7 –Ω–∞–≤—ã–∫–æ–≤")

# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –ø–µ—Ä–≤–æ–π –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∫–Ω–∏–≥–∏
if books:
    book_id = books[0]["id"]
    details = await get_book_details(book_id)
    
    # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ
    file_path = await download_book(book_id)
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞
- **–ú–æ–¥–µ–ª–∏** (`models/`) - dataclass –æ–±—ä–µ–∫—Ç—ã –¥–ª—è Book –∏ Author
- **–°–µ—Ä–≤–∏—Å—ã** (`services/`) - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç, –ø–∞—Ä—Å–µ—Ä –∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
- **–¢–µ—Å—Ç—ã** (`tests/`) - —é–Ω–∏—Ç —Ç–µ—Å—Ç—ã —Å –º–æ–∫–∞–º–∏ –∏ —Ä–µ–∞–ª—å–Ω—ã–º–∏ HTML –ø—Ä–∏–º–µ—Ä–∞–º–∏
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (`config.py`) - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü—Ä–∏–Ω—Ü–∏–ø—ã
- **Fail Fast** - –±—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
- **Type Hints** - –ø–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤ —Å—Ç–∏–ª–µ Python 3.12
- **Async/Await** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Dependency Injection** - —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ `construct.py`
- **TDD** - —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç—ã

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è
ruff check .

# –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
ruff check --fix .

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pytest tests/
```

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π MCP —Å–µ—Ä–≤–µ—Ä**

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:
- –ü–æ–∏—Å–∫ –∫–Ω–∏–≥ –∏ –∞–≤—Ç–æ—Ä–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –∫–Ω–∏–≥
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤ EPUB —Ñ–æ—Ä–º–∞—Ç–µ
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –ø–∞–ø–∫–∞ –∑–∞–≥—Ä—É–∑–æ–∫
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã

## –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### v2.0 - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ—Ä–∏–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–µ

‚úÖ **–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ—Ä–∏–π –∫–Ω–∏–≥** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ –ø–∞—Ä—Å–∏–Ω–≥ —Å–µ—Ä–∏–π
- **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è** - –ø–∞—Ä–∞–º–µ—Ç—Ä `order="date"` 
- **–ù–æ–≤—ã–µ MCP —Ñ—É–Ω–∫—Ü–∏–∏** - `get_author_series()` –∏ `get_series_books()`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–Ω–∏–≥–∏ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–æ–≤
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å Book** - –ø–æ–ª—è `series_name`, `series_id`, `added_date`

### –ü—Ä–∏–º–µ—Ä—ã –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–Ω–∏–≥ –∞–≤—Ç–æ—Ä–∞ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ –¥–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
# –¢–µ–ø–µ—Ä—å sort_by="date" –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–∫–∞–∑ –¥–∞—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è!
books = await search_books_by_author("5803", sort_by="date", books_limit=10)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä–∏–π –∞–≤—Ç–æ—Ä–∞  
series = await get_author_series("5803")

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–Ω–∏–≥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–µ—Ä–∏–∏
series_books = await get_series_books("18510")
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- ‚úÖ **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–∏–≥** - —É–±—Ä–∞–Ω—ã –ø–æ–≤—Ç–æ—Ä—ã –∏–∑-–∑–∞ download-—Å—Å—ã–ª–æ–∫
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞—Ç—ã** - `sort_by="date"` —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** - –∫–∞–∂–¥–∞—è –∫–Ω–∏–≥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!